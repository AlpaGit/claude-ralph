Ralph Desktop Orchestrator - Progress Tracker
===============================================

p1-02: Implement DB migration system            [DONE]
  - MigrationRunner class (src/main/runtime/migrations/migration-runner.ts)
  - Creates schema_migrations table to track applied migrations
  - Scans numbered .sql files from disk, sorts by numeric prefix
  - Applies unapplied migrations in order within transactions
  - 001_initial.sql (resources/migrations/001_initial.sql)
  - Current schema with IF NOT EXISTS guards for existing DBs
  - AppDatabase constructor updated to accept migrationsDir param
  - Replaces inline CREATE TABLE with MigrationRunner.run()
  - index.ts updated to resolve migrationsDir (dev vs packaged)

p1-03: Extract theme tokens into tokens.css       [DONE]
  - Created src/renderer/tokens.css with all CSS custom properties
  - Fonts: --font-sans (Space Grotesk), --font-mono (IBM Plex Mono)
  - Colors: core palette, gradients, surfaces, borders, wizard, thinking, status, feedback, log
  - Border radius: --radius-sm (8px) through --radius-circle (999px)
  - Box shadows: --shadow-hero, --shadow-panel
  - Transitions: --transition-fast (100ms ease-in-out)
  - Spacing: --space-xs through --space-xl
  - Layout: --max-width-app, --opacity-disabled
  - Updated src/renderer/styles.css to @import ./tokens.css
  - Replaced all hardcoded hex colors, font-family, border-radius, shadows with var() refs
  - Removed :root block from styles.css (moved to tokens.css)
  - Build and typecheck pass

p1-08: Install and configure Zustand stores       [DONE]
  - Installed zustand@5 and immer@10 as production dependencies
  - src/renderer/stores/planStore.ts
    - State: currentPlan, plansList, loadingPlan, loadingList, creating, error
    - Actions: createPlan, loadPlan, loadPlanList, deletePlan, archivePlan, clearError
    - Wraps window.ralphApi.createPlan and getPlan; list/delete/archive are stubs pending backend IPC
  - src/renderer/stores/runStore.ts
    - State: activeRuns map, runLogs map, runTodos map, selectedRunId, recentEvents
    - Actions: startRun, cancelRun, appendLog, appendTodo, selectRun
    - Uses immer middleware for efficient nested map updates
    - initRunEventSubscription() exported for one-time setup from App.tsx
    - Internal _handleRunEvent dispatches started/log/todo_update/completed/failed/cancelled events
  - src/renderer/stores/discoveryStore.ts
    - State: interview, answers, events, loading, error
    - Actions: startDiscovery, continueDiscovery, reset
    - Subscribes to onDiscoveryEvent during startDiscovery; cleans up on reset
  - src/renderer/stores/settingsStore.ts
    - State: modelConfig map (planning/discovery/execution/wizard roles), loading, error
    - Actions: loadSettings, updateModelForRole
    - Defaults all roles to claude-opus-4-6; stubs pending backend settings IPC
  - Build and typecheck pass

p1-04: Create UButton component with CSS Module   [DONE]
  - src/renderer/components/ui/UButton.tsx
    - forwardRef component accepting all ButtonHTMLAttributes
    - Variants: primary, secondary, ghost, danger (default: primary)
    - Sizes: sm, md, lg (default: md)
    - Loading state: renders a CSS spinner, sets aria-busy, disables interaction
    - Disabled state: reduced opacity, not-allowed cursor
    - Exports UButtonProps, UButtonVariant, UButtonSize types
    - Uses simple cn() helper for conditional class composition (no clsx dep)
  - src/renderer/components/ui/UButton.module.css
    - Extracted .action-btn base + variant styles from styles.css into CSS Module
    - Brutalist style: 2px solid border, bold weight, Space Grotesk font
    - Hover translateY(-1px), active translateY(0) micro-interaction
    - focus-visible outline (2px solid accent, 2px offset) for accessibility
    - Size presets with appropriate padding and font-size
    - Loading spinner via CSS animation (border-based spinner)
    - All values reference tokens.css custom properties
  - Build and typecheck pass

p1-05: Create UCard, UStatusPill, UInput, UTextArea components  [DONE]
  - src/renderer/components/UCard/UCard.tsx
    - Bordered panel container with optional title, subtitle, headerAction, footer slots
    - Uses consistent padding/margin via tokens.css spacing variables
    - Accepts children as body content, className for composition
  - src/renderer/components/UCard/UCard.module.css
    - Extracted .panel / .panel-header patterns from styles.css into CSS Module
    - Flex column layout with gap, dashed border footer separator
  - src/renderer/components/UStatusPill/UStatusPill.tsx
    - Colored badge for plan/task/run status values with automatic color mapping
    - STATUS_COLOR_MAP: pending=#6b7280, in_progress=#d97706, completed=#15803d,
      failed=#b91c1c, cancelled=#6b7280, draft=#6b7280, ready=#156f67,
      running=#d97706, queued=#6b7280
    - Optional colored dot indicator, label override, className
    - Uses CSS custom properties (--pill-color, --pill-bg) for dynamic styling
  - src/renderer/components/UStatusPill/UStatusPill.module.css
    - Extracted .status-pill / .status-* patterns from styles.css into CSS Module
    - Pill border radius, mono font, uppercase text transform
  - src/renderer/components/UInput/UInput.tsx
    - Text input with label, error state, helper text
    - Extends InputHTMLAttributes for full native input API passthrough
    - Auto-generates id via useId, wires label/aria-describedby/aria-invalid
  - src/renderer/components/UInput/UInput.module.css
    - Extracted .text-input / .label patterns from styles.css into CSS Module
    - Focus state with accent-2 border, disabled opacity, error border color
  - src/renderer/components/UTextArea/UTextArea.tsx
    - Multi-line textarea with label, error state, char count, and auto-resize
    - Extends TextareaHTMLAttributes for full native textarea API passthrough
    - Auto-resize via ref + scrollHeight measurement on change and value update
    - Live character counter with over-limit warning when maxLength is set
  - src/renderer/components/UTextArea/UTextArea.module.css
    - Extracted .text-area / .label patterns from styles.css into CSS Module
    - Footer row with justified error/helper text and char count
    - Auto-resize class disables manual resize and hides overflow
  - src/renderer/components/ui.ts -- barrel export for all four UI primitives
  - Build and typecheck pass

p1-06: Create UModal and USkeleton components   [DONE]
  - src/renderer/components/UModal/UModal.tsx
    - UModal: dialog overlay with title, body (children), footer actions, close button
    - Uses React.createPortal to render outside component tree (creates #u-modal-root)
    - Backdrop click-to-close, Escape key to close
    - aria-modal, role="dialog", aria-label for accessibility
    - Focus trap: Tab/Shift+Tab cycles through focusable elements inside dialog
    - Saves and restores focus on open/close
    - Locks body scroll while open
    - UConfirmModal: convenience wrapper with confirm/cancel buttons
    - Supports confirmVariant ("primary" | "danger"), loading state, custom labels
    - Exports UModalProps, UConfirmModalProps types
  - src/renderer/components/UModal/UModal.module.css
    - Brutalist panel styling: 2px solid border, --radius-panel, --shadow-panel
    - Backdrop with rgba overlay and fade-in animation
    - Dialog slide-up + scale entrance animation (150ms ease-out)
    - Header with title and close button, dashed border footer separator
    - Close button with hover translateY(-1px) micro-interaction
    - focus-visible outline for accessibility
    - All values reference tokens.css custom properties
  - src/renderer/components/USkeleton/USkeleton.tsx
    - Animated placeholder for loading states
    - Variants: text (line), card (rectangle), circle (avatar)
    - Configurable width, height, lines (multi-line text), lineGap
    - Multi-line text variant: last line shorter (65%) for natural appearance
    - role="status" and aria-label="Loading" for accessibility
    - Exports USkeletonProps, USkeletonVariant types
  - src/renderer/components/USkeleton/USkeleton.module.css
    - Pulse animation: subtle 1.5s ease-in-out infinite between --color-surface and --color-surface-warm
    - Text variant: 0.9em height, --radius-sm, full width
    - Card variant: 120px height, --radius-panel, 2px border
    - Circle variant: 2.5rem diameter, --radius-circle
    - All values reference tokens.css custom properties
  - src/renderer/components/ui.ts -- barrel export updated with UModal, UConfirmModal, USkeleton
  - Build and typecheck pass

p1-07: Create ULogViewer component with virtualization   [DONE]
  - Installed react-window@2 as production dependency (v2 ships bundled types, no @types needed)
  - src/renderer/components/ui/RingBuffer.ts
    - Generic circular fixed-capacity array for log line storage
    - Default capacity 5 000 lines, configurable via constructor
    - Circular array with head pointer and count tracking
    - push() O(1): appends item, overwrites oldest when full
    - get(index) O(1): retrieves item at logical index (0 = oldest)
    - toArray() O(n): returns all items in insertion order
    - clear(): resets buffer to empty state
    - Exports RingBuffer class
  - src/renderer/components/ui/ULogViewer.tsx
    - Virtualized log viewer using react-window v2 List component
    - rowHeight 20px (IBM Plex Mono line height), overscanCount 20
    - Accepts external lines[] prop or uses internal RingBuffer via imperative handle
    - Auto-scroll to bottom (toggleable): tracks visible rows via onRowsRendered
    - Disables auto-scroll when user scrolls up, re-enables on button click
    - Line numbers: 1-based, right-aligned, non-selectable
    - ANSI color support: strips ANSI escape codes via regex (\x1b\[[0-9;]*[A-Za-z])
    - Search/filter input: case-insensitive substring match, shows match count
    - Expand-to-fullscreen toggle: fixed position overlay with z-index 9999
    - Copy-all button: copies all visible (filtered) lines to clipboard via navigator.clipboard
    - Scroll-to-bottom indicator button when auto-scroll is off
    - Footer status bar showing line count and capacity
    - ULogViewerHandle interface for imperative push/pushMany/clear/copyAll/scrollToBottom
    - Exports ULogViewerProps, ULogViewerHandle types
  - src/renderer/components/ui/ULogViewer.module.css
    - Dark terminal theme: --color-log-bg (#111), --color-log-text (#e6e6e6)
    - Toolbar: search input, auto-scroll toggle, copy button, fullscreen toggle
    - Fullscreen mode: position fixed, inset 0, z-index 9999
    - Row hover highlight, search match highlight (accent rgba)
    - Line number column: fixed width, right-aligned, muted color
    - Scroll-to-bottom indicator: absolute positioned pill button
    - All values reference tokens.css custom properties
  - src/renderer/components/ui.ts -- barrel export updated with ULogViewer, ULogViewerHandle, RingBuffer
  - Build and typecheck pass
